---
date: "2021-03-14T23:03:01+08:00"
title: "Introduction to Operating Systems"
authors: ["zhannicholas"]
categories:
  - 读书笔记
tags:
  - OSTEP
draft: false
toc: true
---

程序运行时会发生什么？

一个正在运行的程序会做一件非常简单的事情：执行指令。CPU 从内存中取出（fetch）一条指令，对其进行译码（decode），然后执行（execute）它，保存执行结果，紧接着又去取指令，译码，执行指令……，如此周而复始，反复循环，使得计算机能够自动地工作。除非遇到停机指令（程序执行完成），否则这个循环将一直进行下去。

![程序的执行过程](/images/reading_notes/ostep/execution-process_of_a_procedure.jpg "程序的执行过程")

## 虚拟化

> 关键问题：如何将资源虚拟化？

操作系统负责确保既易使用又高效地运行，为此，它将物理资源（处理器、内存或磁盘）转换为更通用、更强大且更易于使用的虚拟形式，因此，我们有时也将操作系统称为虚拟机。为了让用户可以告诉操作系统要做什么，操作系统提供了一些 API（或者说系统调用）供程序调用。由于操作系统提供这些调用来运行程序、访问内存和设备、进行其它操作，所以我们有时也会说操作系统为应用程序提供了一个 **标准库（standard library）**。

操作系统早期被称为 **super visor** 或 **master control program**。因为虚拟化让许多程序运行（从而共享 CPU），让许多程序可以同时访问自己的指令和数据（从而共享内存），让许多程序访问设备（从而共享磁盘等），所以操作系统又被称为 **资源管理器（resource manager）**。每个 CPU、内存和磁盘都是系统的资源，因此操作系统扮演的主要角色就是管理这些资源，做到高效公平，或实现其它预定目标。

在硬件的帮助下，操作系统负责提供系统拥有非常多的虚拟 CPU 的假象。将单个 CPU（或其中一小部分）转换成为看似无限数量的 CPU，从而让许多程序看似在同时运行，这就是所谓的 **虚拟化 CPU**。

内存是一个字节数组。要读取内存，必须指定一个地址，才能访问存储在那里的数据。要写入或更新内存，还必须执行要向给定地址写入的数据。每个进程访问自己的私有虚拟地址空间（有时也直接称为地址空间），操作系统以某种方式将虚拟地址空间映射到机器的物理内存上去。一个正在运行的程序中的内存引用不会影响到其他进程（或操作系统本身）的地址空间。对于正在运行的程序，它完全拥有自己的物理内存。这就是 **虚拟化内存**。

## 并发

> 关键问题：如何构建正确的并发程序？

## 持久化

> 关键问题：如何持久化地存储数据？

在系统内存中，数据容易丢失，因为像 DRAM 这样的设备以易失（volatile）的方式存储数据。如果断电或系统崩溃，内存中的所有数据都会丢失。因此，我们需要硬件和软件来持久地存储数据。这样的存储对于所有系统都很重要，因为用户非常关心他们的数据。

操作系统中管理磁盘的软件通常为称为文件系统，它负责可靠高效地将用户创建的任何文件存储在系统的磁盘上。不想操作系统为 CPU 和内存提供的抽象，操作系统不会为每个应用程序创建专用的虚拟硬盘，相反，它假设用户经常需要 **共享** 文件中的信息。

## 操作系统的设计目标

操作系统取得 CPU、内存或磁盘等物理资源（resources），并对它们进行虚拟化（virtualize）。它处理与并发（concurrency）有关的麻烦事儿。它持久地（persistently）存储文件，从而使它们长期安全。我们希望建立这样一个系统，所以要有一些目标，以帮助我们集中设计和实现，并在必要时进行折中。找到合适的折中是建立系统的关键。以下是一些目标：

* 建立一些抽象，让系统方便易用。
* 提供高性能（最小化操作系统的开销）。
* 在应用程序之间以及在 OS 与应用程序之间提供保护。保护是操作系统和核心原理之一（即隔离），**让进程彼此隔离是保护的关键**。

## 参考资料

1. [CPU的工作过程](https://software.intel.com/content/www/cn/zh/develop/articles/book-processor-architecture_cpu_work_process.htm).
